# Story E4.1 — Cadastro de Clientes e Rotas Fixas
**Epic:** E4 — Logística
**Status:** Ready for Review
**Criado por:** @sm (River) | 2026-02-19
**Complexidade:** M (5 pontos)

---

## Descrição
Como **Gerente de Unidade**, preciso cadastrar os clientes (lojas B2B e pessoas físicas) com endereços e associá-los a rotas de coleta/entrega fixas, para que o sistema possa gerar o romaneio diário automaticamente.

---

## Critérios de Aceite

- [x] **AC1:** CRUD de clientes em `/unit/[unitId]/clients` — campos: nome, tipo (pf/pj), documento, telefone, endereço completo, ativo
- [x] **AC2:** CRUD de rotas em `/unit/[unitId]/routes` — nome da rota, turno (morning/afternoon/evening), motorista associado (opcional), dias da semana
- [x] **AC3:** Associar clientes a paradas na rota (rota tem N paradas em sequência)
- [x] **AC4:** Listagem de rotas com clientes por rota
- [x] **AC5:** Cliente pode aparecer em múltiplas rotas

---

## Escopo
**IN:** Cadastro de clientes, rotas fixas, paradas
**OUT:** Roteirização automática (Wave 3), app motorista (E4.3)

---

## Contexto Técnico

```sql
-- 010_logistics.sql
-- Tabelas: clients (expandida), logistics_routes, route_stops
```

## File List (preenchido por @dev)
- [x] `supabase/migrations/010_logistics.sql`
- [x] `types/logistics.ts`
- [x] `actions/clients/crud.ts`
- [x] `actions/routes/crud.ts`
- [x] `components/domain/client/client-form-dialog.tsx`
- [x] `components/domain/client/client-list.tsx`
- [x] `components/domain/logistics/route-form-dialog.tsx`
- [x] `components/domain/logistics/route-list.tsx`
- [x] `app/(unit)/[unitId]/clients/page.tsx`
- [x] `app/(unit)/[unitId]/routes/page.tsx`
- [x] `components/layout/unit-sidebar.tsx` (links Clientes e Rotas adicionados)

## Dev Agent Record
### Agent Model Used
claude-sonnet-4-6

## Change Log
| Data | Agente | Ação |
|------|--------|------|
| 2026-02-19 | @sm River | Story criada (Status: Ready) |
| 2026-02-19 | @dev Dex | Implementação completa. Status → Ready for Review |
