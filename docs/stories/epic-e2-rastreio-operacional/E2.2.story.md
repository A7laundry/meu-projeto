# Story E2.2 — Etiqueta e QR Code da Comanda
**Epic:** E2 — Rastreio Operacional Core
**Status:** Ready for Review
**Criado por:** @sm (River) | 2026-02-18
**Complexidade:** S (3 pontos)

---

## Descrição
Como **atendente**, após criar a comanda, preciso imprimir ou exibir uma etiqueta com QR Code único, para que os funcionários de cada setor possam identificar e registrar a comanda rapidamente via scan ou digitação do número.

---

## Critérios de Aceite

- [x] **AC1:** QR Code gerado automaticamente para cada comanda contendo o `order_id` (UUID)
- [x] **AC2:** Página de etiqueta imprimível (`/orders/[orderId]/label`) com layout otimizado para impressão térmica 80mm
- [x] **AC3:** Etiqueta contém: QR Code, número da comanda, nome do cliente, data de promessa, quantidade de itens, tipo(s) de peça
- [x] **AC4:** Botão "Imprimir Etiqueta" na página de detalhe da comanda
- [x] **AC5:** QR Code também exibível em tela (para scan por tablet do setor sem impressora)
- [x] **AC6:** Código de barras alternativo (Code 128) gerado junto ao QR para scanners lineares

---

## Escopo

**IN:**
- Geração de QR Code
- Layout de etiqueta imprimível
- Exibição em tela

**OUT:**
- Integração com impressora via Bluetooth (Wave 2)
- Etiquetas por item individual (Wave 2 — por ora, 1 etiqueta por comanda)

---

## Contexto Técnico (para @dev)

### Bibliotecas
```bash
npm install qrcode react-qr-code
npm install jsbarcode  # Code 128
```

### Componente QR (`components/domain/order/order-qr-label.tsx`)
```typescript
import QRCode from 'react-qr-code'
// value = order_id (UUID)
// Tamanho: 150x150 para etiqueta
```

### CSS de impressão
```css
@media print {
  body * { visibility: hidden; }
  #label-print, #label-print * { visibility: visible; }
  #label-print {
    position: absolute; top: 0; left: 0;
    width: 80mm; /* impressora térmica */
  }
}
```

---

## Dependências
- E2.1 (Criação de comanda) — **completo**

## Definição de Pronto
- [ ] Todos os ACs marcados
- [ ] QR Code testado com scanner de celular
- [ ] Impressão testada (Chrome Print Preview)

---

## File List (preenchido por @dev)
- [x] `app/(unit)/[unitId]/production/orders/[orderId]/label/page.tsx`
- [x] `components/domain/order/order-qr-label.tsx`

## Change Log
| Data | Agente | Ação |
|------|--------|------|
| 2026-02-18 | @sm River | Story criada (Status: Ready) |
| 2026-02-18 | @dev Dex | Implementação concluída — 6/6 ACs. Status: Ready for Review |
