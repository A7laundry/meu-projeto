# Story E8.1 — Alertas Executivos e Relatórios Históricos
**Epic:** E8 — Alertas e Relatórios
**Status:** Ready for Review
**Criado por:** @sm (River) | 2026-02-19
**Complexidade:** M (5 pontos)

---

## Critérios de Aceite

- [x] **AC1:** Thresholds de alerta configuráveis via `kpi-thresholds.ts` (ruptura > 15%, SLA > 5, sem KPI de insumo)
- [x] **AC2:** Função `evaluateKpiAlerts(kpis)` retorna lista de alertas ativos com nível (warning/critical) e mensagem
- [x] **AC3:** Componente `ExecutiveAlerts` exibe alertas no dashboard do Diretor quando há itens fora do target
- [x] **AC4:** Página `/director/reports` expandida com filtro de período (últimos 7/30/90 dias) e download CSV
- [x] **AC5:** Query `getHistoricalKpis` agrega comandas, receita e ruptura por dia para o período selecionado
- [x] **AC6:** Tabela histórica com sparkline simples (barras CSS) na página de relatórios

---

## File List (preenchido por @dev)
- [x] `lib/kpi-thresholds.ts`
- [x] `actions/director/alerts.ts`
- [x] `components/domain/director/executive-alerts.tsx`
- [x] `actions/director/historical.ts`
- [x] `app/(director)/reports/page.tsx` (substituído por Server Component com tabela histórica)
- [x] `app/(director)/dashboard/page.tsx` (seção alertas executivos adicionada)
- [x] `app/api/director/export-kpis/route.ts` (suporte a parâmetro `days`)

## Dev Agent Record
### Agent Model Used
claude-sonnet-4-6

## Change Log
| Data | Agente | Ação |
|------|--------|------|
| 2026-02-19 | @sm River | Story criada (Status: Ready) |
| 2026-02-19 | @dev Dex | Implementação completa. Status → Ready for Review |
