# Story E3.3 — Insumos Químicos: Cadastro e Estoque
**Epic:** E3 — Gestão de Equipamentos e Insumos
**Status:** Ready for Review
**Criado por:** @sm (River) | 2026-02-19
**Complexidade:** L (8 pontos)

---

## Critérios de Aceite

- [x] **AC1:** CRUD de produtos químicos em `/unit/[unitId]/supplies`
- [x] **AC2:** Campos: nome, categoria, unidade de medida, custo por unidade, fornecedor
- [x] **AC3:** Registro de movimentação de estoque: entrada (compra) e saída (uso manual)
- [x] **AC4:** Saldo atual de cada produto visível na listagem (calculado por movimentações)
- [x] **AC5:** Alerta visual quando estoque abaixo do mínimo configurável por produto
- [ ] **AC6:** Histórico de movimentações por produto (últimas 30 entradas) — modal de histórico pendente
- [ ] **AC7:** Vincular produtos às receitas de lavagem — integração recipe_chemicals pendente

---

## File List (preenchido por @dev)
- [x] `supabase/migrations/009_chemical_products.sql`
- [x] `types/chemical.ts`
- [x] `actions/chemicals/crud.ts`
- [x] `actions/chemicals/movements.ts`
- [x] `components/domain/chemical/chemical-form-dialog.tsx`
- [x] `components/domain/chemical/chemical-movement-form.tsx`
- [x] `components/domain/chemical/chemical-list.tsx`
- [x] `app/(unit)/[unitId]/supplies/page.tsx`

## Dev Agent Record

### Agent Model Used
claude-sonnet-4-6

### Completion Notes
- AC6 (histórico de movimentações modal) pendente — a action `listMovements` existe, UI pendente para Wave 2
- AC7 (recipe_chemicals) — tabela criada na migration, UI de vínculo pendente para Wave 2
- Saldo calculado no backend via reduce de movimentações; em escala usar materialized view (Wave 2)

## Change Log
| Data | Agente | Ação |
|------|--------|------|
| 2026-02-19 | @sm River | Story criada (Status: Ready) |
| 2026-02-19 | @dev Dex | Implementação principal. Status → Ready for Review |
