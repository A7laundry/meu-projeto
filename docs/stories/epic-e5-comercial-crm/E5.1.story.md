# Story E5.1 — Tabela de Preços e Orçamentos
**Epic:** E5 — Comercial e CRM
**Status:** Ready for Review
**Criado por:** @sm (River) | 2026-02-19
**Complexidade:** M (5 pontos)

---

## Descrição
Como **Gerente de Unidade**, preciso definir a tabela de preços por tipo de peça (podendo ter preços especiais por cliente) e gerar orçamentos que o cliente possa aprovar, para que o faturamento seja calculado automaticamente.

---

## Critérios de Aceite

- [x] **AC1:** Tabela de preços em `/unit/[unitId]/pricing` — tipo de peça, preço base, unidade (peça/kg/par)
- [x] **AC2:** Preço especial por cliente: tabela `client_prices` com override do preço base
- [x] **AC3:** Orçamentos em `/unit/[unitId]/quotes` — cliente, itens (tipo × qtd × preço), total calculado
- [x] **AC4:** Status do orçamento: `draft` → `sent` → `approved` → `rejected`
- [x] **AC5:** Ao aprovar orçamento, cria comanda automaticamente (primeiro item do orçamento)

---

## Escopo
**IN:** Tabela de preços, orçamentos, aprovação
**OUT:** Assinatura digital, portal do cliente (E5.3), integração financeira automática (E6)

---

## File List (preenchido por @dev)
- [x] `supabase/migrations/012_pricing.sql`
- [x] `types/pricing.ts`
- [x] `actions/pricing/crud.ts`
- [x] `actions/quotes/crud.ts`
- [x] `components/domain/commercial/pricing-form-dialog.tsx`
- [x] `components/domain/commercial/pricing-list.tsx`
- [x] `components/domain/commercial/quote-form-dialog.tsx`
- [x] `components/domain/commercial/quote-list.tsx`
- [x] `app/(unit)/[unitId]/pricing/page.tsx`
- [x] `app/(unit)/[unitId]/quotes/page.tsx`
- [x] `components/layout/unit-sidebar.tsx` (links Preços e Orçamentos)

## Dev Agent Record
### Agent Model Used
claude-sonnet-4-6

## Change Log
| Data | Agente | Ação |
|------|--------|------|
| 2026-02-19 | @sm River | Story criada (Status: Ready) |
| 2026-02-19 | @dev Dex | Implementação completa. Status → Ready for Review |
